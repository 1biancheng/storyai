<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>主题颜色对比度测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .test-card {
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .contrast-info {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }
        .contrast-pass {
            color: #4CAF50;
            font-weight: bold;
        }
        .contrast-fail {
            color: #F44336;
            font-weight: bold;
        }
        .contrast-borderline {
            color: #FF9800;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>主题颜色对比度测试</h1>
    <p>测试经典色系和温柔色系的颜色对比度是否符合WCAG 2.1 AA标准</p>
    
    <div class="test-grid" id="testGrid"></div>
    
    <script>
        // 经典色系配色方案 - 优化对比度
        const classicColorPalette = [
          { primaryColor: '#2D2D2D', primaryTextColor: '#FFFFFF', editorBgColor: '#1E1E1E', editorTextColor: '#FFFFFF', themeName: '经典黑' },
          { primaryColor: '#5A2DB8', primaryTextColor: '#FFFFFF', editorBgColor: '#1A0F33', editorTextColor: '#FFFFFF', themeName: '深紫罗兰' },
          { primaryColor: '#0F7A75', primaryTextColor: '#FFFFFF', editorBgColor: '#0D2E2C', editorTextColor: '#FFFFFF', themeName: '深青绿' },
          { primaryColor: '#B8860B', primaryTextColor: '#FFFFFF', editorBgColor: '#2D2110', editorTextColor: '#FFFFFF', themeName: '深金棕' },
          { primaryColor: '#6A4C6A', primaryTextColor: '#FFFFFF', editorBgColor: '#2A2126', editorTextColor: '#FFFFFF', themeName: '深紫灰' },
          { primaryColor: '#696969', primaryTextColor: '#FFFFFF', editorBgColor: '#2E2E2D', editorTextColor: '#FFFFFF', themeName: '深石灰' },
          { primaryColor: '#A0A2D0', primaryTextColor: '#000000', editorBgColor: '#E6E7F4', editorTextColor: '#000000', themeName: '浅紫蓝' },
          { primaryColor: '#5A7A3A', primaryTextColor: '#FFFFFF', editorBgColor: '#1F2617', editorTextColor: '#FFFFFF', themeName: '深橄榄' }
        ];

        // 温柔色系配色方案 - 优化对比度
        const gentleColorPalette = [
          { primaryColor: '#E91E63', primaryTextColor: '#FFFFFF', editorBgColor: '#330E17', editorTextColor: '#FFFFFF', themeName: '热情粉红' },
          { primaryColor: '#FF7043', primaryTextColor: '#FFFFFF', editorBgColor: '#3D1E1C', editorTextColor: '#FFFFFF', themeName: '温柔珊瑚' },
          { primaryColor: '#F5DEB3', primaryTextColor: '#000000', editorBgColor: '#FDF2E3', editorTextColor: '#000000', themeName: '奶油杏色' },
          { primaryColor: '#D4D4AA', primaryTextColor: '#000000', editorBgColor: '#F5F5E6', editorTextColor: '#000000', themeName: '淡雅橄榄' },
          { primaryColor: '#4DB6AC', primaryTextColor: '#FFFFFF', editorBgColor: '#1A2D26', editorTextColor: '#FFFFFF', themeName: '清新薄荷' }
        ];

        // 计算相对亮度
        function getLuminance(color) {
            const rgb = hexToRgb(color);
            const [r, g, b] = rgb.map(c => {
                c = c / 255;
                return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
            });
            return 0.2126 * r + 0.7152 * g + 0.0722 * b;
        }

        // 十六进制转RGB
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? [
                parseInt(result[1], 16),
                parseInt(result[2], 16),
                parseInt(result[3], 16)
            ] : null;
        }

        // 计算对比度
        function getContrastRatio(color1, color2) {
            const lum1 = getLuminance(color1);
            const lum2 = getLuminance(color2);
            const brightest = Math.max(lum1, lum2);
            const darkest = Math.min(lum1, lum2);
            return (brightest + 0.05) / (darkest + 0.05);
        }

        // 获取对比度等级
        function getContrastLevel(ratio) {
            if (ratio >= 7) return { level: 'AAA', class: 'contrast-pass' };
            if (ratio >= 4.5) return { level: 'AA', class: 'contrast-pass' };
            if (ratio >= 3) return { level: 'AA Large', class: 'contrast-borderline' };
            return { level: 'Fail', class: 'contrast-fail' };
        }

        // 生成测试卡片
        function generateTestCards() {
            const testGrid = document.getElementById('testGrid');
            const allThemes = [...classicColorPalette, ...gentleColorPalette];
            
            allThemes.forEach(theme => {
                // 主色调与文字对比度
                const primaryContrast = getContrastRatio(theme.primaryColor, theme.primaryTextColor);
                const primaryLevel = getContrastLevel(primaryContrast);
                
                // 编辑器背景与文字对比度
                const editorContrast = getContrastRatio(theme.editorBgColor, theme.editorTextColor);
                const editorLevel = getContrastLevel(editorContrast);
                
                const card = document.createElement('div');
                card.className = 'test-card';
                card.style.backgroundColor = theme.primaryColor;
                card.style.color = theme.primaryTextColor;
                
                card.innerHTML = `
                    <h3>${theme.themeName}</h3>
                    <div style="background-color: ${theme.editorBgColor}; color: ${theme.editorTextColor}; padding: 10px; border-radius: 4px; margin: 10px 0;">
                        <small>编辑器预览</small>
                    </div>
                    <div class="contrast-info">
                        <div>主色调对比度: <span class="${primaryLevel.class}">${primaryContrast.toFixed(2)} (${primaryLevel.level})</span></div>
                        <div>编辑器对比度: <span class="${editorLevel.class}">${editorContrast.toFixed(2)} (${editorLevel.level})</span></div>
                    </div>
                `;
                
                testGrid.appendChild(card);
            });
        }

        // 页面加载完成后生成测试卡片
        document.addEventListener('DOMContentLoaded', generateTestCards);
    </script>
</body>
</html>