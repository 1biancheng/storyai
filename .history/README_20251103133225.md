# Star小说生成系统

一个基于AI的智能小说创作平台,提供从创意构思到内容生成的全流程支持.

## 功能特点

- 智能段落生成与拼接
- 多模型支持(OpenAI、Claude、国产大模型等)
- 可视化工作流编辑器
- 段落库管理与检索
- 实时协作与版本控制

## 技术栈

### 前端
- React 18 + TypeScript
- Tailwind CSS
- Vite
- SWR (状态管理)

### 后端
- Python + FastAPI
- PostgreSQL + pgvector
- Apache AGE (图数据库)

## 安装与运行

### 环境要求

- Node.js 16+
- Python 3.8+
- PostgreSQL 12+

### 前端安装

1. 安装依赖:
   ```bash
   npm install
   ```

2. 配置环境变量:
   创建 `.env.local` 文件并设置:
   ```
   OPENAI_API_KEY=your_openai_api_key
   ```

3. 启动开发服务器:
   ```bash
   npm run dev
   ```

### 后端安装

1. 进入后端目录:
   ```bash
   cd backend
   ```

2. 安装Python依赖:
   ```bash
   pip install -r requirements.txt
   ```

3. 配置环境变量:
   创建 `.env` 文件并设置:
   ```
   DATABASE_URL=postgresql://username:password@localhost:5432/story_ai
   OPENAI_API_KEY=your_openai_api_key
   ```

4. 初始化数据库:
   ```bash
   python scripts/init_db.py
   ```

5. 启动后端服务:
   ```bash
   python main.py
   ```

## 项目结构

```
story-ai/
├── src/                 # 前端源码
│   ├── components/      # React组件
│   ├── pages/          # 页面组件
│   ├── services/       # API服务
│   └── utils/          # 工具函数
├── backend/            # 后端源码
│   ├── routers/        # API路由
│   ├── services/       # 业务逻辑
│   ├── models/         # 数据模型
│   └── tests/          # 测试文件
└── docs/              # 项目文档
```

## 开发指南

### 添加新模型

1. 在 `backend/services/ai_service.py` 中添加模型配置
2. 更新前端模型选择器组件
3. 添加相应的测试用例

### 扩展工作流节点

1. 在 `src/components/workflow/` 中创建新节点组件
2. 在 `backend/services/workflow.py` 中添加处理逻辑
3. 更新工作流类型定义

## 部署

### Docker部署

```bash
# 构建镜像
docker-compose build

# 启动服务
docker-compose up -d
```

### 生产环境部署

1. 配置生产环境变量
2. 构建前端资源:
   ```bash
   npm run build
   ```
3. 使用Gunicorn启动后端:
   ```bash
   gunicorn main:app --host 0.0.0.0 --port 8000
   ```

## API文档

启动后端服务后,访问 `http://localhost:8000/docs` 查看完整API文档.

## 贡献指南

1. Fork项目
2. 创建功能分支
3. 提交更改
4. 发起Pull Request

## 许可证

本项目采用 Apache-2.0 许可证.详见 [LICENSE](LICENSE) 文件.

## 支持

如有问题,请提交Issue或联系项目维护者.
